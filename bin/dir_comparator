#!/bin/bash

#Compare 2 directories with all metadata (permission)

#Check args validity
if [ $# -ne 3 ]
then
	echo "Usage $0 : pathDir1 pathDir2 optionConfig(manual[1]/auto[2])"
	exit 1
elif [[ ! -d $1 ]]
then
	echo "Directory not found : $1"
	exit 2
elif [[ ! -d $2 ]]
then
	echo "Directory not found : $2"
	exit 2
elif [ $3 -ne 1 -a $3 -ne 0 ]
then
	echo "Unknow optionConfig ! Use 0 for a manual management of conflicts or 1 for an automatic one"
	exit 3
fi

#Compare permission
permDir1=$(stat -c %a $1)
permDir2=$(stat -c %a $2)
if [ $permDir1 -ne $permDir2 ]
then
	echo "Dir Permission conflict ! "
	bin/conflict/conflict_manager 3 $3 $1 $2
fi

exit 0
